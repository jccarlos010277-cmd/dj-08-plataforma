<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DJ-08 Automatizada - Declaraci√≥n Jurada Inteligente</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Banner de Advertencia TCP -->
    <div class="tcp-warning" id="tcpWarning">
        <div class="warning-content">
            <i class="fas fa-exclamation-triangle"></i>
            <span><strong>üö® ATENCI√ìN TCP:</strong> Los pagos a cuenta son DEFINITIVOS. La ONAT NO realiza devoluciones de excedentes pagados en anticipos.</span>
            <button class="close-warning" onclick="closeWarning()">&times;</button>
        </div>
    </div>

    <!-- Encabezado -->
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo">
                        <i class="fas fa-file-invoice-dollar"></i>
                        <div>
                            <h1>DJ-08<span class="logo-sub">Automatizada</span></h1>
                            <p class="tagline">Declaraci√≥n Jurada Inteligente con Asesoramiento en Tiempo Real</p>
                        </div>
                    </div>
                </div>
                
                <div class="user-controls">
                    <div class="tcp-selector">
                        <label class="switch">
                            <input type="checkbox" id="tcpToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="tcp-label"><i class="fas fa-user-tie"></i> Modo TCP</span>
                    </div>
                    
                    <button class="btn-help" onclick="showHelp()">
                        <i class="fas fa-question-circle"></i> Ayuda
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Navegaci√≥n por Secciones -->
    <nav class="section-nav">
        <div class="container">
            <ul class="nav-tabs">
                <li class="nav-item active" data-section="seccion-a">
                    <i class="fas fa-chart-line"></i> <span>Secci√≥n A<br><small>Ingresos</small></span>
                </li>
                <li class="nav-item" data-section="seccion-b">
                    <i class="fas fa-calculator"></i> <span>Secci√≥n B<br><small>Gastos</small></span>
                </li>
                <li class="nav-item" data-section="seccion-c">
                    <i class="fas fa-adjust"></i> <span>Secci√≥n D<br><small>Ajustes</small></span>
                </li>
                <li class="nav-item" data-section="seccion-d">
                    <i class="fas fa-file-invoice-dollar"></i> <span>Secci√≥n C<br><small>Liquidaci√≥n</small></span>
                </li>
            </ul>
        </div>
    </nav>

    <main class="container">
        <!-- Secci√≥n A: Ingresos -->
        <section id="seccion-a" class="form-section active">
            <div class="section-header">
                <h2><i class="fas fa-chart-line"></i> Secci√≥n A: Captura de Ingresos</h2>
                <p class="section-guide">Complete sus datos de ventas y servicios. Cada campo incluye asesoramiento espec√≠fico.</p>
            </div>
            
            <div class="form-grid">
                <!-- Ventas Brutas -->
                <div class="form-card">
                    <h3><i class="fas fa-shopping-cart"></i> Ventas y Servicios</h3>
                    
                    <div class="form-group">
                        <label for="ventasBrutasTotales">
                            <i class="fas fa-dollar-sign"></i> Ventas Brutas Totales (A√±o completo):
                            <span class="label-help" onclick="mostrarAsesoramiento('ventasBrutasTotales')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-chart-bar"></i>
                            <input type="number" id="ventasBrutasTotales" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionA()"
                                   onfocus="mostrarAsesoramiento('ventasBrutasTotales')">
                        </div>
                        <small class="form-text">üí∞ Acumulado informativo de todo el a√±o</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="ventasPeriodo">
                            <i class="fas fa-calendar-alt"></i> Ventas del Per√≠odo Impositivo:
                            <span class="label-help" onclick="mostrarAsesoramiento('ventasPeriodo')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-calendar-check"></i>
                            <input type="number" id="ventasPeriodo" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionA()"
                                   onfocus="mostrarAsesoramiento('ventasPeriodo')">
                        </div>
                        <small class="form-text">üìÖ Solo meses donde corresponde pagar impuestos</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="devolucionesVentas">
                            <i class="fas fa-undo-alt"></i> Devoluciones en Ventas:
                            <span class="label-help" onclick="mostrarAsesoramiento('devolucionesVentas')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-exchange-alt"></i>
                            <input type="number" id="devolucionesVentas" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionA()"
                                   onfocus="mostrarAsesoramiento('devolucionesVentas')">
                        </div>
                        <small class="form-text">üîÑ Monto de productos devueltos por clientes</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="impuestoVentas">
                            <i class="fas fa-percentage"></i> Impuesto sobre Ventas:
                            <span class="label-help" onclick="mostrarAsesoramiento('impuestoVentas')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-file-invoice"></i>
                            <input type="number" id="impuestoVentas" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionA()"
                                   onfocus="mostrarAsesoramiento('impuestoVentas')">
                        </div>
                        <small class="form-text">üèõÔ∏è Impuesto recaudado que debe declarar</small>
                    </div>
                </div>
                
                <!-- Otros Ingresos -->
                <div class="form-card">
                    <h3><i class="fas fa-money-bill-wave"></i> Otros Ingresos</h3>
                    
                    <div class="form-group">
                        <label for="ventaActivos">
                            <i class="fas fa-industry"></i> Venta de Activos:
                            <span class="label-help" onclick="mostrarAsesoramiento('ventaActivos')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-truck-loading"></i>
                            <input type="number" id="ventaActivos" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionA()">
                        </div>
                        <small class="form-text">üè≠ Venta de maquinaria, equipos o propiedades</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="donaciones">
                            <i class="fas fa-hand-holding-heart"></i> Donaciones Recibidas:
                            <span class="label-help" onclick="mostrarAsesoramiento('donaciones')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-gift"></i>
                            <input type="number" id="donaciones" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionA()">
                        </div>
                        <small class="form-text">üìú Art. 75 Ley Sistema Tributario</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="otrosIngresos">
                            <i class="fas fa-plus-circle"></i> Otros Ingresos No Operativos:
                            <span class="label-help" onclick="mostrarAsesoramiento('otrosIngresos')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-coins"></i>
                            <input type="number" id="otrosIngresos" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionA()">
                        </div>
                        <small class="form-text">üíº Intereses, alquileres, servicios t√©cnicos</small>
                    </div>
                </div>
                
                <!-- Resultados Secci√≥n A -->
                <div class="form-card results-card">
                    <h3><i class="fas fa-calculator"></i> Resultados Secci√≥n A</h3>
                    
                    <div class="calculation-steps">
                        <div class="result-item">
                            <span>Ingresos Brutos Totales:</span>
                            <span id="ingresosBrutos" class="result-value">$0.00</span>
                        </div>
                        
                        <div class="result-item deduction">
                            <span>(-) Devoluciones:</span>
                            <span id="totalDevoluciones" class="result-value">$0.00</span>
                        </div>
                        
                        <div class="result-item deduction">
                            <span>(-) Impuesto Ventas:</span>
                            <span id="totalImpuestoVentas" class="result-value">$0.00</span>
                        </div>
                        
                        <hr class="result-divider">
                        
                        <div class="result-item total">
                            <span><strong>INGRESOS NETOS:</strong></span>
                            <span id="ingresosNetos" class="result-value total-value">$0.00</span>
                        </div>
                    </div>
                    
                    <div class="result-note">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>üìã Listo para continuar:</strong> Este valor se transfiere autom√°ticamente a la Secci√≥n B
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section-navigation">
                <div class="progress-info">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 25%"></div>
                    </div>
                    <span>Paso 1 de 4</span>
                </div>
                <button class="btn-next" onclick="showSection('seccion-b')">
                    Continuar a Secci√≥n B <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </section>

        <!-- Secci√≥n B: Gastos y Utilidad -->
        <section id="seccion-b" class="form-section">
            <div class="section-header">
                <h2><i class="fas fa-calculator"></i> Secci√≥n B: Gastos y Utilidad del Per√≠odo</h2>
                <p class="section-guide">Registre sus gastos deducibles seg√∫n sus libros de contabilidad.</p>
            </div>
            
            <div class="form-grid">
                <!-- Costos y Gastos -->
                <div class="form-card">
                    <h3><i class="fas fa-file-invoice"></i> Costos y Gastos Deducibles</h3>
                    
                    <div class="form-group">
                        <label for="costoVentas">
                            <i class="fas fa-boxes"></i> Costo de Ventas:
                            <span class="label-help" onclick="mostrarAsesoramiento('costoVentas')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-box-open"></i>
                            <input type="number" id="costoVentas" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionB()"
                                   onfocus="mostrarAsesoramiento('costoVentas')">
                        </div>
                        <small class="form-text">üì¶ Materias primas, productos para venta</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="gastosAdministracion">
                            <i class="fas fa-user-tie"></i> Gastos de Administraci√≥n:
                            <span class="label-help" onclick="mostrarAsesoramiento('gastosAdministracion')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-briefcase"></i>
                            <input type="number" id="gastosAdministracion" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionB()"
                                   onfocus="mostrarAsesoramiento('gastosAdministracion')">
                        </div>
                        <small class="form-text">üè¢ Sueldos administrativos, alquiler, servicios</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="gastosOperacion">
                            <i class="fas fa-cogs"></i> Gastos de Operaci√≥n:
                            <span class="label-help" onclick="mostrarAsesoramiento('gastosOperacion')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-tools"></i>
                            <input type="number" id="gastosOperacion" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionB()">
                        </div>
                        <small class="form-text">üîß Mantenimiento, reparaciones, combustibles</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="gastosFinancieros">
                            <i class="fas fa-hand-holding-usd"></i> Gastos Financieros (Intereses):
                            <span class="label-help" onclick="mostrarAsesoramiento('gastosFinancieros')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-credit-card"></i>
                            <input type="number" id="gastosFinancieros" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionB()"
                                   onfocus="mostrarAsesoramiento('gastosFinancieros')">
                        </div>
                        <small class="form-text">üí≥ Intereses de cr√©ditos y pr√©stamos</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="otrosGastos">
                            <i class="fas fa-receipt"></i> Otros Gastos Deducibles:
                            <span class="label-help" onclick="mostrarAsesoramiento('otrosGastos')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-file-contract"></i>
                            <input type="number" id="otrosGastos" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionB()">
                        </div>
                        <small class="form-text">üìù Publicidad, capacitaci√≥n, asesor√≠as</small>
                    </div>
                </div>
                
                <!-- Resultados Secci√≥n B -->
                <div class="form-card results-card">
                    <h3><i class="fas fa-balance-scale"></i> Utilidad del Per√≠odo</h3>
                    
                    <div class="calculation-steps">
                        <div class="result-item">
                            <span>Ingresos Netos (Secci√≥n A):</span>
                            <span id="ingresosNetosB" class="result-value">$0.00</span>
                        </div>
                        
                        <div class="result-item deduction">
                            <span>(-) Costo de Ventas:</span>
                            <span id="totalCostoVentas" class="result-value">$0.00</span>
                        </div>
                        
                        <div class="result-item deduction">
                            <span>(-) Gastos Administraci√≥n:</span>
                            <span id="totalGastosAdmin" class="result-value">$0.00</span>
                        </div>
                        
                        <div class="result-item deduction">
                            <span>(-) Gastos Operaci√≥n:</span>
                            <span id="totalGastosOperacion" class="result-value">$0.00</span>
                        </div>
                        
                        <div class="result-item deduction">
                            <span>(-) Gastos Financieros:</span>
                            <span id="totalGastosFinancieros" class="result-value">$0.00</span>
                        </div>
                        
                        <div class="result-item deduction">
                            <span>(-) Otros Gastos:</span>
                            <span id="totalOtrosGastos" class="result-value">$0.00</span>
                        </div>
                        
                        <hr class="result-divider">
                        
                        <div class="result-item total">
                            <span><strong>UTILIDAD ANTES DE AJUSTES:</strong></span>
                            <span id="utilidadAntesAjustes" class="result-value total-value">$0.00</span>
                        </div>
                    </div>
                    
                    <div class="result-note">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>‚öñÔ∏è Ajustes pendientes:</strong> Este valor ser√° ajustado en la Secci√≥n D con adiciones y deducciones
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section-navigation">
                <div class="progress-info">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 50%"></div>
                    </div>
                    <span>Paso 2 de 4</span>
                </div>
                <div class="nav-buttons">
                    <button class="btn-prev" onclick="showSection('seccion-a')">
                        <i class="fas fa-arrow-left"></i> Volver a Secci√≥n A
                    </button>
                    <button class="btn-next" onclick="showSection('seccion-c')">
                        Continuar a Secci√≥n D <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </section>

        <!-- Secci√≥n C: Ajustes Fiscales -->
        <section id="seccion-c" class="form-section">
            <div class="section-header">
                <h2><i class="fas fa-adjust"></i> Secci√≥n D: Ajustes Fiscales</h2>
                <p class="section-guide">Ajustes (adiciones y deducciones) requeridos por la normativa tributaria.</p>
            </div>
            
            <div class="form-grid">
                <!-- Adiciones -->
                <div class="form-card additions-card">
                    <h3 class="additions-title"><i class="fas fa-plus-circle"></i> Adiciones (Suman a la utilidad)</h3>
                    
                    <div class="form-group">
                        <label for="ajusteDepreciacion">
                            <i class="fas fa-chart-line"></i> Ajuste por Depreciaci√≥n:
                            <span class="label-help" onclick="mostrarAsesoramiento('ajusteDepreciacion')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-tachometer-alt"></i>
                            <input type="number" id="ajusteDepreciacion" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionC()"
                                   onfocus="mostrarAsesoramiento('ajusteDepreciacion')">
                        </div>
                        <small class="form-text">üìä Diferencia por tasas superiores a las legales</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="multasRecargos">
                            <i class="fas fa-gavel"></i> Multas y Recargos:
                            <span class="label-help" onclick="mostrarAsesoramiento('multasRecargos')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                            <input type="number" id="multasRecargos" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionC()">
                        </div>
                        <small class="form-text">‚öñÔ∏è Gastos no deducibles por disposici√≥n legal</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="cuentasIncobrables">
                            <i class="fas fa-file-invoice-dollar"></i> Cancelaci√≥n Cuentas Incobrables:
                            <span class="label-help" onclick="mostrarAsesoramiento('cuentasIncobrables')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-times-circle"></i>
                            <input type="number" id="cuentasIncobrables" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionC()">
                        </div>
                        <small class="form-text">üí∏ Excedente sobre provisi√≥n creada</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="otrasAdiciones">
                            <i class="fas fa-plus"></i> Otras Adiciones:
                            <span class="label-help" onclick="mostrarAsesoramiento('otrasAdiciones')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-plus-square"></i>
                            <input type="number" id="otrasAdiciones" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionC()">
                        </div>
                        <small class="form-text">üìà Otros ajustes positivos requeridos</small>
                    </div>
                </div>
                
                <!-- Deducciones -->
                <div class="form-card deductions-card">
                    <h3 class="deductions-title"><i class="fas fa-minus-circle"></i> Deducciones (Restan de la utilidad)</h3>
                    
                    <div class="form-group">
                        <label for="reservaContingencias">
                            <i class="fas fa-shield-alt"></i> Reserva para Contingencias:
                            <span class="label-help" onclick="mostrarAsesoramiento('reservaContingencias')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-group">
                            <div class="input-with-icon">
                                <i class="fas fa-piggy-bank"></i>
                                <input type="number" id="reservaContingencias" min="0" step="0.01" 
                                       placeholder="0.00" oninput="calcularSeccionC()"
                                       onfocus="mostrarAsesoramiento('reservaContingencias')">
                            </div>
                            <button class="btn-calc" onclick="calcularReservaContingencias()">
                                <i class="fas fa-calculator"></i> Calcular Auto
                            </button>
                        </div>
                        <small class="form-text">üõ°Ô∏è % sobre gastos totales (generalmente 10%)</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="ingresosNoImponibles">
                            <i class="fas fa-ban"></i> Ingresos No Imponibles:
                            <span class="label-help" onclick="mostrarAsesoramiento('ingresosNoImponibles')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-hand-holding-usd"></i>
                            <input type="number" id="ingresosNoImponibles" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionC()"
                                   onfocus="mostrarAsesoramiento('ingresosNoImponibles')">
                        </div>
                        <small class="form-text">‚úÖ Rentas exentas por disposici√≥n especial</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="perdidasAnteriores">
                            <i class="fas fa-history"></i> P√©rdidas Fiscales Anteriores:
                            <span class="label-help" onclick="mostrarAsesoramiento('perdidasAnteriores')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-redo"></i>
                            <input type="number" id="perdidasAnteriores" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionC()"
                                   onfocus="mostrarAsesoramiento('perdidasAnteriores')">
                        </div>
                        <small class="form-text">üìÜ Amortizaci√≥n acordada con ONAT</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="otrasDeducciones">
                            <i class="fas fa-minus"></i> Otras Deducciones:
                            <span class="label-help" onclick="mostrarAsesoramiento('otrasDeducciones')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-minus-square"></i>
                            <input type="number" id="otrasDeducciones" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionC()">
                        </div>
                        <small class="form-text">üìâ Otros ajustes negativos permitidos</small>
                    </div>
                </div>
                
                <!-- Resultados Secci√≥n C -->
                <div class="form-card results-card">
                    <h3><i class="fas fa-balance-scale"></i> Resultado de Ajustes</h3>
                    
                    <div class="calculation-steps">
                        <div class="result-item">
                            <span>Utilidad antes de Ajustes:</span>
                            <span id="utilidadAntesAjustesC" class="result-value">$0.00</span>
                        </div>
                        
                        <div class="result-item addition">
                            <span>(+) Total Adiciones:</span>
                            <span id="totalAdiciones" class="result-value">$0.00</span>
                        </div>
                        
                        <div class="result-item deduction">
                            <span>(-) Total Deducciones:</span>
                            <span id="totalDeducciones" class="result-value">$0.00</span>
                        </div>
                        
                        <hr class="result-divider">
                        
                        <div class="result-item total">
                            <span><strong>UTILIDAD NETA IMPONIBLE:</strong></span>
                            <span id="utilidadNetaImponible" class="result-value total-value">$0.00</span>
                        </div>
                    </div>
                    
                    <div class="info-box">
                        <h4><i class="fas fa-lightbulb"></i> ¬øQu√© partidas integran la reserva?</h4>
                        <ul>
                            <li><i class="fas fa-check-circle"></i> Provisiones para riesgos y gastos futuros</li>
                            <li><i class="fas fa-check-circle"></i> Estimaciones para litigios en curso</li>
                            <li><i class="fas fa-check-circle"></i> Previsiones para fluctuaciones del mercado</li>
                            <li><i class="fas fa-check-circle"></i> Generalmente un % sobre gastos totales</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="section-navigation">
                <div class="progress-info">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 75%"></div>
                    </div>
                    <span>Paso 3 de 4</span>
                </div>
                <div class="nav-buttons">
                    <button class="btn-prev" onclick="showSection('seccion-b')">
                        <i class="fas fa-arrow-left"></i> Volver a Secci√≥n B
                    </button>
                    <button class="btn-next" onclick="showSection('seccion-d')">
                        Continuar a Secci√≥n C <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </section>

        <!-- Secci√≥n D: Liquidaci√≥n del Impuesto -->
        <section id="seccion-d" class="form-section">
            <div class="section-header">
                <h2><i class="fas fa-file-invoice-dollar"></i> Secci√≥n C: Liquidaci√≥n del Impuesto</h2>
                <p class="section-guide">C√°lculo final del impuesto a pagar o saldo a favor.</p>
            </div>
            
            <div class="form-grid">
                <!-- C√°lculo del Impuesto -->
                <div class="form-card">
                    <h3><i class="fas fa-calculator"></i> C√°lculo del Impuesto</h3>
                    
                    <div class="alert-tcp" id="tcpAlert">
                        <i class="fas fa-exclamation-circle"></i>
                        <div>
                            <strong>‚ö†Ô∏è ATENCI√ìN TCP:</strong> Los pagos a cuenta son definitivos. 
                            <br>La ONAT NO devuelve excedentes pagados en anticipos.
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="tipoImpositivo">
                            <i class="fas fa-percentage"></i> Tipo Impositivo (%):
                            <span class="label-help" onclick="mostrarAsesoramiento('tipoImpositivo')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-chart-pie"></i>
                            <input type="number" id="tipoImpositivo" min="0" max="100" step="0.1" 
                                   value="35" oninput="calcularSeccionD()"
                                   onfocus="mostrarAsesoramiento('tipoImpositivo')">
                        </div>
                        <small class="form-text">üìä Generalmente 35% (Resoluci√≥n No. 350)</small>
                    </div>
                    
                    <div class="preview-calc">
                        <div class="result-item">
                            <span>Utilidad Neta Imponible:</span>
                            <span id="utilidadNetaImponibleD" class="result-value">$0.00</span>
                        </div>
                        
                        <div class="result-item">
                            <span>Impuesto Bruto (35%):</span>
                            <span id="impuestoBruto" class="result-value">$0.00</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bonificaciones">
                            <i class="fas fa-gift"></i> Bonificaciones Aplicables:
                            <span class="label-help" onclick="mostrarAsesoramiento('bonificaciones')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-award"></i>
                            <input type="number" id="bonificaciones" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionD()">
                        </div>
                        <small class="form-text">üéÅ Beneficios fiscales autorizados</small>
                    </div>
                </div>
                
                <!-- Pagos a Cuenta -->
                <div class="form-card">
                    <h3><i class="fas fa-calendar-check"></i> Pagos a Cuenta</h3>
                    
                    <div class="form-group">
                        <label for="pagoTrimestre1">
                            <i class="fas fa-calendar"></i> 1er Trimestre (Ene-Mar):
                            <span class="label-help" onclick="mostrarAsesoramiento('pagoTrimestre1')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-qrcode"></i>
                            <input type="number" id="pagoTrimestre1" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionD()"
                                   onfocus="mostrarAsesoramiento('pagoTrimestre1')">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="pagoTrimestre2">
                            <i class="fas fa-calendar"></i> 2do Trimestre (Abr-Jun):
                            <span class="label-help" onclick="mostrarAsesoramiento('pagoTrimestre2')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-qrcode"></i>
                            <input type="number" id="pagoTrimestre2" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionD()">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="pagoTrimestre3">
                            <i class="fas fa-calendar"></i> 3er Trimestre (Jul-Sep):
                            <span class="label-help" onclick="mostrarAsesoramiento('pagoTrimestre3')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-qrcode"></i>
                            <input type="number" id="pagoTrimestre3" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionD()">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="pagoTrimestre4">
                            <i class="fas fa-calendar"></i> 4to Trimestre (Oct-Dic):
                            <span class="label-help" onclick="mostrarAsesoramiento('pagoTrimestre4')">
                                <i class="fas fa-question-circle"></i>
                            </span>
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-qrcode"></i>
                            <input type="number" id="pagoTrimestre4" min="0" step="0.01" 
                                   placeholder="0.00" oninput="calcularSeccionD()">
                        </div>
                    </div>
                    
                    <div class="result-item">
                        <span>Total Pagos a Cuenta:</span>
                        <span id="totalPagosCuenta" class="result-value">$0.00</span>
                    </div>
                </div>
                
                <!-- Resultado Final -->
                <div class="form-card results-card final-results">
                    <h3><i class="fas fa-file-signature"></i> Liquidaci√≥n Final</h3>
                    
                    <div class="calculation-steps">
                        <div class="result-item">
                            <span>Impuesto Bruto:</span>
                            <span id="impuestoBrutoFinal" class="result-value">$0.00</span>
                        </div>
                        
                        <div class="result-item deduction">
                            <span>(-) Bonificaciones:</span>
                            <span id="totalBonificaciones" class="result-value">$0.00</span>
                        </div>
                        
                        <div class="result-item deduction">
                            <span>(-) Pagos a Cuenta:</span>
                            <span id="totalPagosCuentaFinal" class="result-value">$0.00</span>
                        </div>
                        
                        <hr class="result-divider">
                        
                        <div class="result-item total">
                            <span><strong>SALDO A PAGAR:</strong></span>
                            <span id="saldoPagar" class="result-value total-value">$0.00</span>
                        </div>
                    </div>
                    
                    <div class="result-note important">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <strong id="tcpNote">Para TCP: Verificar c√°lculo antes de pagar anticipos</strong>
                            <br><small>Los pagos a cuenta son DEFINITIVOS - SIN DEVOLUCI√ìN</small>
                        </div>
                    </div>
                    
                    <div class="info-box">
                        <h4><i class="fas fa-info-circle"></i> Gesti√≥n del Excedente:</h4>
                        <ul>
                            <li><i class="fas fa-building"></i> <strong>Empresas estatales:</strong> Pueden compensar o solicitar devoluci√≥n</li>
                            <li><i class="fas fa-user-tie"></i> <strong>TCP:</strong> Pagos a cuenta son definitivos - SIN DEVOLUCI√ìN</li>
                            <li><i class="fas fa-calculator"></i> Calcular cuidadosamente los anticipos trimestrales</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="final-actions">
                <div class="progress-info">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 100%"></div>
                    </div>
                    <span>Paso 4 de 4 - ¬°Completado!</span>
                </div>
                
                <div class="nav-buttons">
                    <button class="btn-prev" onclick="showSection('seccion-c')">
                        <i class="fas fa-arrow-left"></i> Volver a Secci√≥n D
                    </button>
                    
                    <div class="action-buttons">
                        <button class="btn-export" onclick="exportarDeclaracion()">
                            <i class="fas fa-file-export"></i> Exportar Declaraci√≥n
                        </button>
                        
                        <button class="btn-generar" onclick="generarDeclaracion()">
                            <i class="fas fa-file-pdf"></i> Generar DJ-08
                        </button>
                        
                        <button class="btn-reset" onclick="resetForm()">
                            <i class="fas fa-redo"></i> Nueva Declaraci√≥n
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal de Ayuda -->
    <div id="helpModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-question-circle"></i> Centro de Ayuda - DJ-08 Automatizada</h3>
                <button class="close-modal" onclick="closeHelp()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="help-section">
                    <h4><i class="fas fa-info-circle"></i> ¬øQu√© ingresos son no imponibles?</h4>
                    <ul>
                        <li><i class="fas fa-check"></i> Rentas exentas por disposiciones especiales</li>
                        <li><i class="fas fa-check"></i> Indemnizaciones por seguros</li>
                        <li><i class="fas fa-check"></i> Herencias y donaciones (en ciertas condiciones)</li>
                        <li><i class="fas fa-check"></i> Subsidios estatales espec√≠ficos</li>
                        <li><i class="fas fa-check"></i> Ingresos por exportaci√≥n (en reg√≠menes especiales)</li>
                    </ul>
                </div>
                
                <div class="help-section">
                    <h4><i class="fas fa-exclamation-triangle"></i> Advertencia Importante para TCP</h4>
                    <p>Los Trabajadores por Cuenta Propia deben tener especial cuidado con los pagos a cuenta, ya que:</p>
                    <ul>
                        <li><i class="fas fa-ban"></i> Son pagos <strong>definitivos</strong></li>
                        <li><i class="fas fa-ban"></i> La ONAT <strong>NO realiza devoluciones</strong> de excedentes</li>
                        <li><i class="fas fa-ban"></i> Cualquier sobrepago constituye una p√©rdida</li>
                        <li><i class="fas fa-calculator"></i> Utilice el simulador trimestral para calcular anticipos precisos</li>
                    </ul>
                </div>
                
                <div class="help-section">
                    <h4><i class="fas fa-calculator"></i> C√°lculo Autom√°tico de Reserva</h4>
                    <p>La plataforma calcula autom√°ticamente la reserva para contingencias aplicando un porcentaje sobre el total de gastos. Generalmente se aplica un 10%.</p>
                </div>
                
                <div class="help-section">
                    <h4><i class="fas fa-lightbulb"></i> ¬øC√≥mo usar el sistema de asesoramiento?</h4>
                    <ul>
                        <li><i class="fas fa-mouse-pointer"></i> <strong>Click en el icono ?</strong> junto a cada campo</li>
                        <li><i class="fas fa-keyboard"></i> <strong>O al hacer foco</strong> en el campo de entrada</li>
                        <li><i class="fas fa-info"></i> Aparecer√° informaci√≥n espec√≠fica sobre ese concepto</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <i class="fas fa-file-invoice-dollar"></i>
                    <div>
                        <h4>DJ-08 Automatizada</h4>
                        <p>Plataforma Inteligente de Declaraci√≥n Jurada</p>
                    </div>
                </div>
                <div class="footer-info">
                    <p><i class="fas fa-exclamation-circle"></i> Esta herramienta es de apoyo y no sustituye la asesor√≠a profesional.</p>
                    <p><i class="fas fa-balance-scale"></i> Consulte siempre con un contador especializado.</p>
                    <p class="version">Versi√≥n 2.0 ¬∑ Actualizado: Enero 2024</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>
